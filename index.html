<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Habit Tracker</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial', sans-serif; }
        body { background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); padding: 15px; max-width: 1100px; margin: 0 auto; }
        
        .header { text-align: center; margin-bottom: 25px; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .month-selector { display: flex; gap: 10px; justify-content: center; margin-bottom: 15px; flex-wrap: wrap; }
        .month-btn { padding: 10px 15px; border: 2px solid #4ecdc4; background: white; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .month-btn.active { background: #4ecdc4; color: white; }
        .month-title { font-size: 2.5em; font-weight: bold; background: linear-gradient(45deg, #ff6b6b, #4ecdc4); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .controls { display: flex; gap: 15px; justify-content: center; flex-wrap: wrap; margin-bottom: 20px; }
        input[type="text"] { padding: 12px; border: 2px solid #e9ecef; border-radius: 25px; font-size: 16px; width: 200px; }
        button { background: #4ecdc4; color: white; border: none; padding: 12px 20px; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: bold; transition: all 0.3s; }
        button:hover { background: #45b7aa; transform: translateY(-2px); }
        button.danger { background: #ff6b6b; }
        button.danger:hover { background: #ff5252; }
        
        .tracker-grid { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); margin-bottom: 25px; }
        .grid-title { font-size: 1.8em; margin-bottom: 20px; color: #333; text-align: center; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th.weekday { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); padding: 12px 8px; text-align: center; font-weight: bold; color: #444; font-size: 0.9em; border: 2px solid #e9ecef; }
        th.daynum { background: #f8f9fa; padding: 12px 8px; text-align: center; font-weight: bold; color: #555; border: 2px solid #e9ecef; }
        .habit-name { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px 12px; font-weight: bold; border-radius: 8px 8px 0 0; position: relative; }
        .habit-name button { position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: rgba(255,255,255,0.2); color: white; border: none; width: 25px; height: 25px; border-radius: 50%; cursor: pointer; font-size: 12px; }
        
        td { padding: 8px; border: 2px solid #e9ecef; text-align: center; height: 50px; position: relative; cursor: pointer; transition: all 0.2s; border-radius: 6px; margin: 1px; }
        .habit-cell.empty { background: white; }
        .habit-cell.checked { background: #4ecdc4 !important; color: white; font-weight: bold; }
        .habit-cell.checked::after { content: '‚úì'; font-size: 20px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .habit-cell.missed { background: #ff6b6b !important; color: white; font-weight: bold; }
        .habit-cell.missed::after { content: '‚úó'; font-size: 20px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        .today-highlight { border: 3px solid #ff6b6b !important; box-shadow: 0 0 15px rgba(255,107,107,0.4) !important; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-top: 20px; }
        .stat-card { background: white; padding: 20px; border-radius: 15px; text-align: center; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .stat-number { font-size: 2.5em; font-weight: bold; background: linear-gradient(45deg, #4ecdc4, #44a08d); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        .mood-section { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        canvas { background: white; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        @media (max-width: 768px) { .mood-section { grid-template-columns: 1fr; } table { font-size: 0.8em; } td { height: 40px; padding: 4px; } }
    </style>
</head>
<body>
    <div class="header">
        <div class="month-selector" id="monthSelector"></div>
        <div class="month-title" id="monthTitle">DECEMBER</div>
    </div>
    
    <div class="controls">
        <input type="text" id="newHabit" placeholder="Add new habit...">
        <button onclick="addHabit()">‚ûï Add Habit</button>
        <button onclick="clearMissed()">üóëÔ∏è Clear Missed</button>
        <button onclick="exportData()">üì§ Export</button>
    </div>
    
    <div class="tracker-grid">
        <div class="grid-title">üìä Habit Tracker <span id="completionRate">--%</span></div>
        <table id="habitTable">
            <thead id="tableHead"></thead>
            <tbody id="habitBody"></tbody>
        </table>
    </div>
    
    <div class="stats-grid">
        <div class="stat-card">
            <div>Completion Rate</div>
            <div class="stat-number" id="totalCompletion">--%</div>
        </div>
        <div class="stat-card">
            <div>Streak</div>
            <div class="stat-number" id="currentStreak">-- days</div>
        </div>
        <div class="stat-card">
            <div>Best Habit</div>
            <div class="stat-number" id="bestHabit">--</div>
        </div>
    </div>
    
    <div class="mood-section">
        <div class="tracker-grid">
            <div class="grid-title">üòä Today's Mood</div>
            <div>Mood: <span id="todayMood">--</span>/10 | Sleep: <span id="todaySleep">--</span>h</div>
            <input type="range" id="moodSlider" min="1" max="10" value="5" style="width:100%;">
            <input type="number" id="sleepInput" placeholder="Sleep hours" style="width:80px; padding:8px; margin:10px;">
            <button onclick="saveToday()">üíæ Save</button>
        </div>
        <div class="tracker-grid">
            <div class="grid-title">üìà Habit Graph</div>
            <canvas id="habitChart" width="400" height="200"></canvas>
        </div>
    </div>

    <script>
        let currentMonth = 'DECEMBER';
        let habits = JSON.parse(localStorage.getItem('habits') || '["No sweets","Exercise","Read","Water","Sleep early"]');
        let data = JSON.parse(localStorage.getItem('habitData') || '{}');
        let moodData = JSON.parse(localStorage.getItem('moodData') || '{}');
        
        const MONTH_NAMES = ['JANUARY','FEBRUARY','MARCH','APRIL','MAY','JUNE','JULY','AUGUST','SEPTEMBER','OCTOBER','NOVEMBER','DECEMBER'];
        const WEEKDAYS = ['SUN','MON','TUE','WED','THU','FRI','SAT'];
        
        function saveAll() {
            localStorage.setItem('habits', JSON.stringify(habits));
            localStorage.setItem('habitData', JSON.stringify(data));
            localStorage.setItem('moodData', JSON.stringify(moodData));
        }
        
        function setMonth(month) {
            currentMonth = month;
            document.querySelectorAll('.month-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-month="${month}"]`).classList.add('active');
            document.getElementById('monthTitle').textContent = month;
            renderTable();
            updateStats();
            drawChart();
        }
        
        function renderTable() {
            const thead = document.getElementById('tableHead');
            const tbody = document.getElementById('habitBody');
            const now = new Date();
            const today = now.getDate();
            const todayWeekday = WEEKDAYS[now.getDay()];
            
            // Weekday headers
            let headHTML = '<tr><th></th>';
            for(let i = 0; i < 31; i++) {
                const date = new Date(now.getFullYear(), MONTH_NAMES.indexOf(currentMonth), i+1);
                headHTML += `<th class="weekday">${WEEKDAYS[date.getDay()]}</th>`;
            }
            headHTML += '</tr><tr><th></th>';
            for(let day=1; day<=31; day++) {
                headHTML += `<th class="daynum">${day}</th>`;
            }
            thead.innerHTML = headHTML;
            
            // Habit rows
            tbody.innerHTML = '';
            habits.forEach((habit, habitIndex) => {
                const row = document.createElement('tr');
                const monthKey = `${currentMonth}`;
                const habitKey = `${monthKey}-${habitIndex}`;
                row.innerHTML = `
                    <td class="habit-name">${habit}
                        <button onclick="deleteHabit(${habitIndex})" title="Delete habit">√ó</button>
                    </td>
                    ${Array(31).fill(0).map((_, day) => {
                        const key = `${monthKey}-${day}-${habitIndex}`;
                        const status = data[key];
                        let cellClass = 'habit-cell empty';
                        if(status === 'done') cellClass = 'habit-cell checked';
                        if(status === 'missed') cellClass = 'habit-cell missed';
                        if(day+1 === today) cellClass += ' today-highlight';
                        return `<td class="${cellClass}" onclick="toggleHabit(${habitIndex}, ${day+1})" data-day="${day+1}"></td>`;
                    }).join('')}
                `;
                tbody.appendChild(row);
            });
        }
        
        function toggleHabit(habitIndex, day) {
            const key = `${currentMonth}-${day}-${habitIndex}`;
            if(!data[key]) data[key] = 'empty';
            if(data[key] === 'empty') data[key] = 'done';
            else if(data[key] === 'done') data[key] = 'missed';
            else data[key] = 'done';
            saveAll();
            renderTable();
            updateStats();
        }
        
        function addHabit() {
            const name = document.getElementById('newHabit').value.trim();
            if(name && !habits.includes(name)) {
                habits.push(name);
                saveAll();
                document.getElementById('newHabit').value = '';
                renderTable();
            }
        }
        
        function deleteHabit(index) {
            habits.splice(index, 1);
            // Clean up data
            Object.keys(data).forEach(key => {
                if(key.includes(`-${index}`)) delete data[key];
            });
            saveAll();
            renderTable();
        }
        
        function updateStats() {
            let totalCells = 0, completed = 0;
            habits.forEach((habit, habitIndex) => {
                for(let day=1; day<=31; day++) {
                    const key = `${currentMonth}-${day}-${habitIndex}`;
                    totalCells++;
                    if(data[key] === 'done') completed++;
                }
            });
            const rate = totalCells ? Math.round((completed/totalCells)*100) : 0;
            document.getElementById('completionRate').textContent = ` ${rate}%`;
            document.getElementById('totalCompletion').textContent = `${rate}%`;
        }
        
        function saveToday() {
            const now = new Date();
            const day = now.getDate();
            const key = `${currentMonth}-${day}`;
            moodData[key] = {
                mood: document.getElementById('moodSlider').value,
                sleep: document.getElementById('sleepInput').value
            };
            saveAll();
            updateTodayDisplay();
        }
        
        function updateTodayDisplay() {
            const now = new Date();
            const day = now.getDate();
            const key = `${currentMonth}-${day}`;
            const today = moodData[key];
            if(today) {
                document.getElementById('todayMood').textContent = today.mood;
                document.getElementById('todaySleep').textContent = today.sleep;
                document.getElementById('moodSlider').value = today.mood;
                document.getElementById('sleepInput').value = today.sleep;
            }
        }
        
        function drawChart() {
            const canvas = document.getElementById('habitChart');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            habits.forEach((habit, habitIndex) => {
                ctx.strokeStyle = `hsl(${habitIndex * 30}, 70%, 50%)`;
                ctx.lineWidth = 3;
                ctx.beginPath();
                let first = true;
                for(let day=1; day<=31; day++) {
                    const key = `${currentMonth}-${day}-${habitIndex}`;
                    const value = data[key] === 'done' ? 1 : 0;
                    const x = (day-1) * 12 + 10;
                    const y = canvas.height - (value * 100) - 20;
                    if(first) { ctx.moveTo(x, y); first = false; }
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
            });
        }
        
        function initMonthSelector() {
            const selector = document.getElementById('monthSelector');
            MONTH_NAMES.forEach(month => {
                const btn = document.createElement('button');
                btn.className = 'month-btn';
                btn.textContent = month.slice(0,3);
                btn.dataset.month = month;
                btn.onclick = () => setMonth(month);
                if(month === currentMonth) btn.classList.add('active');
                selector.appendChild(btn);
            });
        }
        
        // Initialize everything
        initMonthSelector();
        renderTable();
        updateTodayDisplay();
        updateStats();
        drawChart();
        
        // Enter to add habit
        document.getElementById('newHabit').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') addHabit();
        });
    </script>
</body>
  </html>
